# SQLite CRUD API

This project is a lightweight REST API for manipulating SQLite databases.  

---

## Why This Exists

I made this API for several reasons:  

1. **Proof of Concept for SQLite manipulation**  
   I wanted to experiment with direct SQLite database manipulation. This API was my testbed, using a language I’m most comfortable with. Instead of building a UI right away, I used Postman to interact with the API and manage data.

2. **Future Work / Electron App**  
   My eventual goal is to build a local Electron app for managing SQLite files. These API functions will map cleanly to the backend of that app and provide a clear structure for what the frontend needs.

3. **Potential Web Use**  
   While a web app wasn’t the original intent, this API could also serve as the backend for one. Anyone else is welcome to use it for a simple, file-based SQLite manipulation API.

4. **Frontend Layout**  
   By designing this API, I’ve effectively created the blueprint for the Electron frontend. The API clarifies what functions are needed at each level of the stack.

---

## API Overview

The API provides **CRUD operations** at 4 distinct layers:

- **Databases**: Create, list, rename, or delete SQLite files.
- **Tables**: Create, search, paginate, sort, edit, and delete tables within a database.
- **Columns**: Define and manage the structure of a table, using metadata for types, tags, and constraints.
- **Rows**: Insert, edit, patch, or delete actual data inside tables.

Additionally, there is a rigid structure to the databases created by this API. Six columns which cannot be deleted, renamed, or moved are:  

- `id`  
- `title`  
- `content`  
- `date_created`  
- `date_modified`  
- `hidden`  

The only two that are necessary to use are `id` and `title`, as `id` is autogenerated and `title` cannot be left blank. You could theoretically hide each of these columns and never use them.

---

## Column Types

All user-defined columns must specify one of the following types:

```
string
integer
float
boolean
rating          // integer 0–5
advanced_rating // float 0–10
date            // unix timestamp (ms)
tags            // space- or comma-separated strings
rich_text       // markdown or similar
link            // JSON string with {displayName: string, url: string}
```

Validation occurs at the API layer to enforce these rules.

---

## Endpoints

### Database Endpoints

#### Create a Database
```http
POST {{baseURL}}/api/database
{
  "name": "test"
}
```

#### Get a Database (metadata + tables, no rows)
```http
GET {{baseURL}}/api/database/:dbId
```

#### List All Databases
```http
GET {{baseURL}}/api/database
```

#### Rename a Database
```http
PUT {{baseURL}}/api/database/:dbId
{
  "newName": "test edited"
}
```

#### Delete a Database
```http
DELETE {{baseURL}}/api/database/:dbId
```

---

### Table Endpoints

#### Create a Table
```http
POST {{baseURL}}/api/database/:dbId/table
{
  "tableName": "my_table"
}
```

#### Get Rows from a Table (supports pagination, search, sorting, hidden filter)
```http
GET {{baseURL}}/api/database/:dbId/table/:tableName?offset=0&limit=10&q=test and hidden:false&s=count:asc
```

#### Rename a Table
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName
{
  "newName": "renamed_table"
}
```

#### Change Table Visibility
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName/visibility
{
  "hidden": true
}
```

#### Delete a Table
```http
DELETE {{baseURL}}/api/database/:dbId/table/:tableName
```

---

### Column Endpoints

#### Create a Column
```http
POST {{baseURL}}/api/database/:dbId/table/:tableName/column
{
  "name": "skill",
  "type": "tags",
  "hidden": false
}
```

#### Get All Columns in a Table
```http
GET {{baseURL}}/api/database/:dbId/table/:tableName/columns
```

#### Get a Single Column
```http
GET {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName
```

#### Rename or Change Column Type
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName
{
  "newName": "skill_level",
  "newType": "string"
}
```

#### Change Column Visibility
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName/visibility
{
  "hidden": true
}
```

#### Swap Column Index
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName/swap
{
  "targetIndex": 6
}
```

#### Move Column Index
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName/move
{
  "newIndex": 6
}
```

#### Register a Tag for a Column
```http
POST {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName/tag
{
  "name": "novice",
  "description": "Entry-level"
}
```

#### Unregister a Tag
```http
DELETE {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName/tag
{
  "tag": "novice"
}
```

#### Delete a Column
```http
DELETE {{baseURL}}/api/database/:dbId/table/:tableName/column/:columnName
```

---

### Row Endpoints

#### Create a Row
```http
POST {{baseURL}}/api/database/:dbId/table/:tableName/row
{
  "title": "New Row",
  "content": "Some content"
}
```

#### Get a Single Row
```http
GET {{baseURL}}/api/database/:dbId/table/:tableName/row/:rowId
```

#### Update Row Visibility
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName/row/:rowId/visibility
{
  "hidden": true
}
```

#### Patch Row Data
```http
PATCH {{baseURL}}/api/database/:dbId/table/:tableName/row/:rowId
{
  "content": "Edited content"
}
```

#### Delete a Row
```http
DELETE {{baseURL}}/api/database/:dbId/table/:tableName/row/:rowId
```

---

## Notes

- Six **system columns** (`id`, `title`, `content`, `date_created`, `date_modified`, `hidden`) cannot be deleted, renamed, moved, or retyped.  
- All user-defined columns must declare a valid type (see column types above).  
- Search (`q`), sort (`s`), hidden filtering, and pagination (`offset`, `limit`) are supported for table queries.  
- Tags require registration before being assigned to rows.  
- Rich text is stored as plain strings and must be formatted and handled on the frontend.
